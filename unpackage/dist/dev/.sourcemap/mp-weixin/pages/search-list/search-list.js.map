{"version":3,"sources":["uni-app:///main.js","webpack:///D:/鎴戠殑鏂囨。/我的文档/HBuilderProjects/uniapp手机商城/pages/search-list/search-list.vue?cfc9","webpack:///D:/鎴戠殑鏂囨。/我的文档/HBuilderProjects/uniapp手机商城/pages/search-list/search-list.vue?3636","webpack:///D:/鎴戠殑鏂囨。/我的文档/HBuilderProjects/uniapp手机商城/pages/search-list/search-list.vue?e1cb","webpack:///D:/鎴戠殑鏂囨。/我的文档/HBuilderProjects/uniapp手机商城/pages/search-list/search-list.vue?6614","uni-app:///pages/search-list/search-list.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,6G;AACAA,UAAU,CAACC,mBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAwH;AACxH;AAC+D;AACL;;;AAG1D;AAC+K;AAC/K,gBAAgB,6KAAU;AAC1B,EAAE,iFAAM;AACR,EAAE,sFAAM;AACR,EAAE,+FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,0FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAoqB,CAAgB,qnBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACgFxrB,+F;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA7BA,cACA,eADA,EAEA,8CAFA,EAGA,cAHA,EAIA,WAJA,EAKA,iBALA,EAMA,eANA,IAQA,EACA,eADA,EAEA,8CAFA,EAGA,cAHA,EAIA,WAJA,EAKA,iBALA,EAMA,eANA,EARA,EAgBA,EACA,eADA,EAEA,8CAFA,EAGA,cAHA,EAIA,WAJA,EAKA,iBALA,EAMA,eANA,EAhBA,E,glDA+BA,EACA,cACA,oBADA,EAEA,UAFA,EAGA,4BAHA,EAIA,sBAJA,EAKA,gBALA,EADA,EAQA,IARA,kBAQA,CACA,SACA;AACA,wBAFA,EAGA,OAHA,EAIA,WAJA,EAKA,QALA,EAMA,gBANA,EAOA,UACA,eADA,EAEA,SACA,UADA,EAEA,SAFA,EAGA,UAHA,IAKA,EACA,UADA,EAEA,SAFA,EAGA,iBAHA,EALA,EAUA,EACA,UADA,EAEA,SAFA,EAGA,gBAHA,EAVA,CAFA,EAPA,EA0BA,SACA,WADA,EAEA,SACA,UADA,EAEA,WAFA,EAGA,YAHA,IAKA,EACA,YADA,EAEA,eAFA,EAGA,aAHA,EALA,EAUA,EACA,cADA,EAEA,eAFA;AAGA,yBAHA,EAVA;;AAeA;AACA,yBADA;AAEA,yBAFA;AAGA,0BAHA,EAfA;;AAoBA;AACA,0BADA;AAEA,yBAFA;AAGA,2BAHA,EApBA;;AAyBA;AACA,wBADA;AAEA,mBAFA;AAGA,uBAHA,EAzBA,CAFA,EA1BA;;;;AA4DA;AACA,mBA7DA;AA8DA,oBA9DA;;AAgEA,GAzEA;AA0EA;AACA;AACA,WAFA,qBAEA;AACA;AACA;AACA;AACA,aADA,EACA,KADA;;AAGA;AACA,KATA,EA1EA;;AAqFA;AACA;AACA,cAFA,wBAEA;AACA;AACA;AACA;AACA,KANA;AAOA;AACA,cARA,wBAQA;AACA;AACA;AACA;AACA;AACA,KAbA;AAcA,gBAdA,wBAcA,KAdA,EAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAhCA;AAiCA;AACA,gBAlCA,0BAkCA;AACA;AACA;AACA;AACA,2CADA;AAEA,QAFA;AAGA,KAxCA;AAyCA;AACA,SA1CA,mBA0CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAlDA;AAmDA;AACA,WApDA,qBAoDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA5DA;AA6DA;AACA,eA9DA,yBA8DA;AACA;AACA;AACA;AACA,KAlEA;AAmEA;AACA,WApEA,qBAoEA;AACA;AACA;AACA,2BADA;AAEA,uBAFA;;AAIA,kBAJA;;AAMA,oBANA;AAOA,UAPA,CAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAfA;AAgBA,KAtFA;AAuFA;AACA,UAxFA,kBAwFA,GAxFA,EAwFA;AACA;AACA;AACA,sBADA,GACA,GADA;AAEA;AACA,qBADA;AAEA,2BAFA;AAGA,8BAHA;AAIA,yBAJA;AAKA,gCALA;AAMA,0CANA;AAOA,6CAPA;;AASA,OAZA;AAaA,KAtGA;AAuGA,UAvGA,oBAuGA;AACA;AACA;AACA,0BADA;AAEA,sBAFA;;AAIA;;;;;;AAMA;AACA;;AAEA;;AAEA,KAxHA;AAyHA,cAzHA,wBAyHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA;AACA,KAvIA,EArFA;;AA8NA,QA9NA,kBA8NA,CA9NA,EA8NA;AACA;AACA;AACA;AACA,GAlOA;AAmOA,eAnOA,2BAmOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GA1OA;AA2OA,mBA3OA,+BA2OA;AACA;AACA;AACA,qBADA;AAEA,oBAFA;;AAIA;AACA,KANA;AAOA,GAnPA;AAoPA,mCApPA,6CAoPA,CApPA,EAoPA;AACA;AACA,GAtPA;AAuPA,qCAvPA,iDAuPA;;AAEA;AACA;AACA,GA3PA;AA4PA,0BA5PA,sCA4PA;AACA;AACA;AACA;AACA,GAhQA,E","file":"pages/search-list/search-list.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/search-list/search-list.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./search-list.vue?vue&type=template&id=1116b14e&\"\nvar renderjs\nimport script from \"./search-list.vue?vue&type=script&lang=js&\"\nexport * from \"./search-list.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/search-list/search-list.vue\"\nexport default component.exports","export * from \"-!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search-list.vue?vue&type=template&id=1116b14e&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search-list.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../新建文件夹/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search-list.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"animate__animated animate__fadeIn\">\r\n\t\t<!-- 排序筛选 -->\r\n\t\t<view class=\"d-flex border-top border-bottom a-center position-fixed bg-white left-0 right-0\" \r\n\t\tstyle=\"height: 100upx; z-index: 100;\">\r\n\t\t\t<view class=\"flex-1 d-flex a-center j-center font-md\" v-for=\"(item,index) in screen.list\" :key=\"index\"\r\n\t\t\t\t@tap=\"changeScreen(index)\">\r\n\t\t\t\t<text :class=\"screen.currentIndex===index? 'main-text-color':'text-muted'\">{{item.name}}</text>\r\n\t\t\t\t<!-- 箭头 -->\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<view class=\"iconfont icon-paixu-shengxu line-h0\"\r\n\t\t\t\t\t\t:class=\"item.status === 1? 'main-text-color':'text-light-muted'\"></view>\r\n\t\t\t\t\t<view class=\"iconfont icon-paixu-jiangxu line-h0\"\r\n\t\t\t\t\t\t:class=\"item.status === 2? 'main-text-color':'text-light-muted'\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"flex-1 d-flex a-center j-center main-text-color\" @tap=\"showDrawer\">\r\n\t\t\t\t筛选\r\n\t\t\t</view>\r\n\t\t\t<!-- 抽屉 -->\r\n\t\t\t<uni-drawer ref=\"showRight\" mode=\"right\" @change=\"closeDrawer\" :width=\"230\">\r\n\t\t\t\t<!-- 上方卡片 -->\r\n\t\t\t\t<card headTitle=\"价格服务\" :headBorderBottom=\"false\" style=\"margin-top: 40px;\" :headTitleWeight=\"false\">\r\n\t\t\t\t\t<!-- 单选按钮组 -->\r\n\t\t\t\t\t<zcmradioGroup :label=\"label\" :selected.sync='label.selected'>\r\n\t\t\t\t\t</zcmradioGroup>\r\n\t\t\t\t</card>\r\n\t\t\t\t<!-- 按钮 -->\r\n\t\t\t\t<view class=\"d-flex position-fixed bottom-0 right-0 w-100\">\r\n\t\t\t\t\t<view class=\"flex-1 main-bg-color text-white font-md py-2 text-center\"\r\n\t\t\t\t\t\thover-class=\"main-bg-hover-color\" @click=\"confirm()\">确定</view>\r\n\t\t\t\t\t<view class=\"flex-1 font-md py-2 text-center\" hover-class=\"bg-light-secondary\" @click=\"reset\">重置\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-drawer>\r\n\t\t</view>\r\n\t\t<view style=\"height: 100rpx;\"></view><!-- 占位 -->\r\n\t\t<!-- 列表 -->\r\n\t\t<block v-for=\"(item,index) in list\" :key='index'>\r\n\t\t\t<searchList :item=\"item\" :index=\"index\"></searchList>\r\n\t\t</block>\r\n\t\t<!-- 没有数据 -->\r\n\t\t<no-thing v-if=\"list.length === 0\" msg=\"空空如也\"></no-thing>\r\n\t\t<!-- 上拉加载更多 -->\r\n\t\t<view class=\"d-flex a-center j-center text-light-muted font-md py-3\">\r\n\t\t\t{{loadtext}}\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tconst demo = [{\r\n\t\t\ttitle: \"真无线路呵呵\",\r\n\t\t\ttitlepic: \"../../static/images/demo/demo6.jpg\",\r\n\t\t\tdesc: \"真无线路呵呵\",\r\n\t\t\tpprice: 100,\r\n\t\t\tcomment_num: 1300,\r\n\t\t\tgood_num: \"98%\"\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"真无线路呵呵\",\r\n\t\t\ttitlepic: \"../../static/images/demo/demo6.jpg\",\r\n\t\t\tdesc: \"真无线路呵呵\",\r\n\t\t\tpprice: 100,\r\n\t\t\tcomment_num: 1300,\r\n\t\t\tgood_num: \"98%\"\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"真无线路呵呵\",\r\n\t\t\ttitlepic: \"../../static/images/demo/demo6.jpg\",\r\n\t\t\tdesc: \"真无线路呵呵\",\r\n\t\t\tpprice: 100,\r\n\t\t\tcomment_num: 1300,\r\n\t\t\tgood_num: \"98%\"\r\n\t\t},\r\n\t]\r\n\timport uniDrawer from \"@/components/uni-ui/uni-drawer/uni-drawer.vue\"\r\n\timport card from \"@/components/common/card.vue\"\r\n\timport zcmradioGroup from \"@/components/common/radio-group.vue\"\r\n\timport searchList from \"@/components/search-list/search-list.vue\"\r\n\timport $H from \"@/comment/lib/request.js\"\r\n\timport noThing from \"@/components/common/no-thing.vue\"\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tuniDrawer,\r\n\t\t\tcard,\r\n\t\t\tzcmradioGroup,\r\n\t\t\tsearchList,\r\n\t\t\tnoThing\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t//上拉加载更多，加载中，没有更多了\r\n\t\t\t\tloadtext: \"上拉加载更多\",\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tkeyword: \"\",\r\n\t\t\t\tlist: [],\r\n\t\t\t\tshowRight: false,\r\n\t\t\t\tscreen: {\r\n\t\t\t\t\tcurrentIndex: 0,\r\n\t\t\t\t\tlist: [{\r\n\t\t\t\t\t\t\tname: \"综合\",\r\n\t\t\t\t\t\t\tstatus: 1,\r\n\t\t\t\t\t\t\tkey: \"all\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"销量\",\r\n\t\t\t\t\t\t\tstatus: 0,\r\n\t\t\t\t\t\t\tkey: \"sale_count\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"价格\",\r\n\t\t\t\t\t\t\tstatus: 0,\r\n\t\t\t\t\t\t\tkey: \"min_price\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\tlabel: {\r\n\t\t\t\t\tselected: 0,\r\n\t\t\t\t\tlist: [{\r\n\t\t\t\t\t\t\tname: \"不限\",\r\n\t\t\t\t\t\t\trule: false,\r\n\t\t\t\t\t\t\tvalue: false\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"0-50\",\r\n\t\t\t\t\t\t\trule: \"between\",\r\n\t\t\t\t\t\t\tvalue: \"0,50\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"50-100\",\r\n\t\t\t\t\t\t\trule: \"between\",\r\n\t\t\t\t\t\t\tvalue: \"50,100\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"100-500\",\r\n\t\t\t\t\t\t\trule: \"between\",\r\n\t\t\t\t\t\t\tvalue: \"100,500\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"500-1000\",\r\n\t\t\t\t\t\t\trule: \"between\",\r\n\t\t\t\t\t\t\tvalue: \"500,1000\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"大于1000\",\r\n\t\t\t\t\t\t\trule: \">\",\r\n\t\t\t\t\t\t\tvalue: \"1000\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t//抽屉选项\r\n\t\t\t\tcondition: {},\r\n\t\t\t\toldSelected: 0,\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t//排序相关\r\n\t\t\toptions() {\r\n\t\t\t\tlet obj = this.screen.list[this.screen.currentIndex]\r\n\t\t\t\tlet value = obj.status === 1 ? 'asc' : 'desc'\r\n\t\t\t\treturn {\r\n\t\t\t\t\t[obj.key]: value\r\n\t\t\t\t}\r\n\t\t\t\t//等价于all:asc\r\n\t\t\t},\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t//在该页面搜索时初始化搜索\r\n\t\t\tinitSearch(){\r\n\t\t\t\tthis.label.selected = 0\r\n\t\t\t\tthis.condition={}\r\n\t\t\t\tthis.page=1\r\n\t\t\t},\r\n\t\t\t//点击打开抽屉\r\n\t\t\tshowDrawer() {\r\n\t\t\t\tif (this.showRight == false) {\r\n\t\t\t\t\tthis.$refs.showRight.open();\r\n\t\t\t\t}\r\n\t\t\t\tthis.oldSelected = this.label.selected\r\n\t\t\t},\r\n\t\t\tchangeScreen(index) {\r\n\t\t\t\t//判断当前点击是否已经是激活状态\r\n\t\t\t\tlet oldIndex = this.screen.currentIndex;\r\n\t\t\t\tlet oldItem = this.screen.list[oldIndex];\r\n\t\t\t\tif (oldIndex == index) {\r\n\t\t\t\t\toldItem.status = oldItem.status === 1 ? 2 : 1\r\n\t\t\t\t\tthis.getData()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlet newitem = this.screen.list[index]\r\n\t\t\t\t//移除激活状态\r\n\t\t\t\toldItem.status = 0;\r\n\t\t\t\tthis.screen.currentIndex = index\r\n\t\t\t\t//增加激活状态\r\n\t\t\t\tnewitem.status = 1;\r\n\t\t\t\t//重新加载数据\r\n\t\t\t\tthis.getData()\r\n\t\t\t\t//小米\r\n\t\t\t},\r\n\t\t\t//组织筛选条件\r\n\t\t\tgetCondition() {\r\n\t\t\t\tlet item = this.label.list[this.label.selected]\r\n\t\t\t\t//如果有值就使用值，如果没有就赋值为空\r\n\t\t\t\tthis.condition = (item.rule && item.value) ? {\r\n\t\t\t\t\tprice: item.rule + \",\" + item.value\r\n\t\t\t\t} : {}\r\n\t\t\t},\r\n\t\t\t//重置\r\n\t\t\treset() {\r\n\t\t\t\tthis.condition = {}\r\n\t\t\t\t//选项回到不限\r\n\t\t\t\tthis.label.selected = 0\r\n\t\t\t\t//获取数据\r\n\t\t\t\tthis.getData()\r\n\t\t\t\t//关闭抽屉\r\n\t\t\t\tthis.$refs.showRight.close();\r\n\t\t\t},\r\n\t\t\t//提交筛选条件\r\n\t\t\tconfirm() {\r\n\t\t\t\t//组织数据筛选条件\r\n\t\t\t\tthis.getCondition()\r\n\t\t\t\t//获取数据\r\n\t\t\t\tthis.getData()\r\n\t\t\t\t//关闭抽屉\r\n\t\t\t\tthis.showRight = false\r\n\t\t\t\tthis.$refs.showRight.close()\r\n\t\t\t},\r\n\t\t\t//关闭抽屉不确定\r\n\t\t\tcloseDrawer() {\r\n\t\t\t\t//恢复原来的值\r\n\t\t\t\tthis.label.selected = this.oldSelected\r\n\t\t\t\t//this.oldSelected = 0\r\n\t\t\t},\r\n\t\t\t//加载数据\r\n\t\t\tgetData(refresh = true, callback = false) {\r\n\t\t\t\tlet page = refresh ? 1 : this.page\r\n\t\t\t\t$H.post('/goods/search', {\r\n\t\t\t\t\ttitle: this.keyword,\r\n\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t//解构参数\r\n\t\t\t\t\t...this.options,\r\n\t\t\t\t\t//筛选\r\n\t\t\t\t\t...this.condition,\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tlet list = this.format(res)\r\n\t\t\t\t\tthis.list = refresh ? [...list] : [...this.list, ...list]\r\n\t\t\t\t\t//恢复加载状态\r\n\t\t\t\t\tthis.loadtext = res.length < 10 ? \"没有更多了\" : \"上拉加载更多\"\r\n\t\t\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//格式化\r\n\t\t\tformat(res) {\r\n\t\t\t\treturn res.map(item => {\r\n\t\t\t\t\tlet good_num = item.comments_count === 0 ? 0 : (item.comments_good_count / item\r\n\t\t\t\t\t\t.comments_count) * 100\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tid: item.id,\r\n\t\t\t\t\t\ttitle: item.title,\r\n\t\t\t\t\t\ttitlepic: item.cover,\r\n\t\t\t\t\t\tdesc: item.desc,\r\n\t\t\t\t\t\tpprice: item.min_price,\r\n\t\t\t\t\t\tcomment_num: item.comments_count,\r\n\t\t\t\t\t\tgood_num: good_num.toFixed(2) + '%'\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tsearch() {\r\n\t\t\t\tif (this.keyword === '') {\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: \"关键字不能为空\",\r\n\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t//#ifdef APP-PLUS\r\n\t\t\t\t//app端\r\n\t\t\t\tplus.key.hideSoftKeybord()\r\n\t\t\t\t//#endif\r\n\t\t\t\t//#ifndef APP-PLUS\r\n\t\t\t\t//隐藏软键盘\r\n\t\t\t\tuni.hideKeyboard()\r\n\t\t\t\t//#endif\r\n\t\t\t\tthis.initSearch()\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\taddHistory() {\r\n\t\t\t\t//拿到本地的搜索历史\r\n\t\t\t\tlet history = uni.getStorageInfoSync(\"searchHistory\")\r\n\t\t\t\thistory ? JSON.parse(history) : []\r\n\t\t\t\t//判断之前是否有搜索记录\r\n\t\t\t\tlet index = history.indexOf(this.keyword)\r\n\t\t\t\tif (index === -1 && this.keyword !== '') {\r\n\t\t\t\t\t//没有添加      \r\n\t\t\t\t\tthis.history.unshift(this.keyword)\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//有，将该搜索记录置顶\r\n\t\t\t\t\tthis.history.unshift(this.history.splice(index, 1)[0])\r\n\t\t\t\t}\r\n\t\t\t\tuni.setStorageSync(\"searchHistory\", JSON.stringify(this.history))\r\n\t\t\t},\r\n\t},\r\n\t\t\tonLoad(e) {\r\n\t\t\t\tthis.keyword = e.keyword\r\n\t\t\t\t//加载数据\r\n\t\t\t\tthis.getData()\r\n\t\t\t},\r\n\t\t\tonReachBottom() {\r\n\t\t\t\t//是否已经处于加载状态\r\n\t\t\t\tif (this.loadtext !== \"上拉加载更多\") return;\r\n\t\t\t\t//改变加载状态\r\n\t\t\t\tthis.loadtext = \"加载中...\"\r\n\t\t\t\tthis.page++;\r\n\t\t\t\tthis.getData(false)\r\n\t\t\t},\r\n\t\t\tonPullDownRefresh() {\r\n\t\t\t\tthis.getData(true, () => {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"刷新成功\",\r\n\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t})\r\n\t\t\t\t\tuni.stopPullDownRefresh()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tonNavigationBarSearchInputChanged(e) {\r\n\t\t\t\tthis.keyword = e.text\r\n\t\t\t},\r\n\t\t\tonNavigationBarSearchInputConfirmed() {\r\n\t\t\t\t\r\n\t\t\t\tthis.search()\r\n\t\t\t\tthis.getData()\r\n\t\t\t},\r\n\t\t\tonNavigationBarButtonTap() {\r\n\t\t\t\tthis.label.selected = 0\r\n\t\t\t\tthis.search()\r\n\t\t\t\tthis.getData()\r\n\t\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\n"],"sourceRoot":""}